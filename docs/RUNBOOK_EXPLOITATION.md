# ğŸ“‹ Runbook d'exploitation - USB Video Vault

## ğŸ”„ **Monitoring quotidien (5-10 min)**

### GitHub Actions - Surveillance continue
```powershell
# ğŸ¤– VÃ©rification quotidienne automatisÃ©e
# Ajouter Ã  votre script de monitoring daily.ps1

$ErrorActionPreference = "Stop"

# 1. VÃ©rifier les builds en Ã©chec
Write-Host "ğŸ” VÃ©rification GitHub Actions..." -ForegroundColor Yellow
$apiUrl = "https://api.github.com/repos/150781/Yindo-USB-Video-Vault/actions/runs?status=failure&per_page=5"
try {
    $failedRuns = Invoke-RestMethod -Uri $apiUrl -Headers @{Accept="application/vnd.github.v3+json"}
    if ($failedRuns.workflow_runs.Count -gt 0) {
        Write-Host "âŒ $($failedRuns.workflow_runs.Count) build(s) en Ã©chec dÃ©tectÃ©(s)" -ForegroundColor Red
        $failedRuns.workflow_runs | ForEach-Object {
            Write-Host "   â€¢ $($_.name): $($_.conclusion) - $($_.html_url)" -ForegroundColor Red
        }
        # Alert: envoyer notification Slack/Teams
    } else {
        Write-Host "âœ… Aucun build en Ã©chec" -ForegroundColor Green
    }
} catch {
    Write-Host "âš ï¸ Impossible de vÃ©rifier GitHub Actions: $($_.Exception.Message)" -ForegroundColor Yellow
}

# 2. VÃ©rifier les issues critiques
$issuesUrl = "https://api.github.com/repos/150781/Yindo-USB-Video-Vault/issues?labels=bug,critical&state=open"
try {
    $criticalIssues = Invoke-RestMethod -Uri $issuesUrl -Headers @{Accept="application/vnd.github.v3+json"}
    if ($criticalIssues.Count -gt 0) {
        Write-Host "ğŸš¨ $($criticalIssues.Count) issue(s) critique(s) ouverte(s)" -ForegroundColor Red
        $criticalIssues | ForEach-Object {
            Write-Host "   â€¢ #$($_.number): $($_.title)" -ForegroundColor Red
        }
    } else {
        Write-Host "âœ… Aucune issue critique ouverte" -ForegroundColor Green
    }
} catch {
    Write-Host "âš ï¸ Impossible de vÃ©rifier les issues: $($_.Exception.Message)" -ForegroundColor Yellow
}

# 3. VÃ©rifier les download stats (si public)
$releasesUrl = "https://api.github.com/repos/150781/Yindo-USB-Video-Vault/releases/latest"
try {
    $latestRelease = Invoke-RestMethod -Uri $releasesUrl -Headers @{Accept="application/vnd.github.v3+json"}
    $totalDownloads = ($latestRelease.assets | Measure-Object download_count -Sum).Sum
    Write-Host "ğŸ“Š Version $($latestRelease.tag_name): $totalDownloads tÃ©lÃ©chargements" -ForegroundColor Cyan
} catch {
    Write-Host "âš ï¸ Impossible de rÃ©cupÃ©rer stats de tÃ©lÃ©chargement" -ForegroundColor Yellow
}

Write-Host "`nâœ… Monitoring quotidien terminÃ© - $(Get-Date -Format 'yyyy-MM-dd HH:mm')" -ForegroundColor Green
```

### Support utilisateur - Tickets ouverts
```powershell
# ğŸ“§ Dashboard support quotidien
Write-Host "`nğŸ“§ Support - Tickets ouverts:" -ForegroundColor Yellow

# GitHub Issues avec label "support"
$supportUrl = "https://api.github.com/repos/150781/Yindo-USB-Video-Vault/issues?labels=support&state=open"
$supportIssues = Invoke-RestMethod -Uri $supportUrl -ErrorAction SilentlyContinue

if ($supportIssues -and $supportIssues.Count -gt 0) {
    Write-Host "ğŸ“‹ $($supportIssues.Count) ticket(s) de support ouvert(s):" -ForegroundColor Cyan
    $supportIssues | ForEach-Object {
        $age = (Get-Date) - [DateTime]$_.created_at
        $ageColor = if ($age.Days -gt 2) { "Red" } elseif ($age.Days -gt 1) { "Yellow" } else { "Green" }
        Write-Host "   â€¢ #$($_.number): $($_.title) ($($age.Days)j)" -ForegroundColor $ageColor
    }
} else {
    Write-Host "âœ… Aucun ticket de support ouvert" -ForegroundColor Green
}
```

## ğŸ“… **Maintenance hebdomadaire (30 min)**

### Audit de sÃ©curitÃ© et mises Ã  jour
```powershell
# ğŸ›¡ï¸ Maintenance sÃ©curitaire hebdomadaire (Ã  planifier le dimanche)

Write-Host "=== Maintenance hebdomadaire USB Video Vault ===" -ForegroundColor Cyan
Write-Host "Date: $(Get-Date -Format 'yyyy-MM-dd HH:mm')" -ForegroundColor Gray
Write-Host ""

# 1. Audit de sÃ©curitÃ© complet
Write-Host "1. ğŸ”’ Audit de sÃ©curitÃ©:" -ForegroundColor Yellow
Set-Location "C:\Path\To\Your\Repo"  # Adapter le chemin
.\tools\security\security-audit.ps1 -Detailed -ExportReport ".\audit-weekly-$(Get-Date -Format 'yyyyMMdd').json"

$auditReport = Get-Content ".\audit-weekly-$(Get-Date -Format 'yyyyMMdd').json" | ConvertFrom-Json
Write-Host "Score de sÃ©curitÃ©: $($auditReport.securityScore)%" -ForegroundColor $(if ($auditReport.securityScore -ge 85) { "Green" } else { "Yellow" })

if ($auditReport.summary.criticalIssues -gt 0) {
    Write-Host "ğŸš¨ $($auditReport.summary.criticalIssues) problÃ¨me(s) critique(s) - ACTION IMMÃ‰DIATE REQUISE" -ForegroundColor Red
}

# 2. Mises Ã  jour des dÃ©pendances
Write-Host "`n2. ğŸ“¦ VÃ©rification des dÃ©pendances:" -ForegroundColor Yellow
npm outdated 2>$null | Tee-Object -Variable outdatedPackages
if ($LASTEXITCODE -eq 0) {
    Write-Host "âœ… Toutes les dÃ©pendances Ã  jour" -ForegroundColor Green
} else {
    Write-Host "âš ï¸ DÃ©pendances obsolÃ¨tes dÃ©tectÃ©es" -ForegroundColor Yellow
    Write-Host "Commande recommandÃ©e: npm update --save" -ForegroundColor Gray
}

# Audit npm des vulnÃ©rabilitÃ©s
npm audit --audit-level=moderate 2>$null
if ($LASTEXITCODE -eq 0) {
    Write-Host "âœ… Aucune vulnÃ©rabilitÃ© npm dÃ©tectÃ©e" -ForegroundColor Green
} else {
    Write-Host "âš ï¸ VulnÃ©rabilitÃ©s npm dÃ©tectÃ©es - exÃ©cutez 'npm audit fix'" -ForegroundColor Yellow
}

# 3. VÃ©rification SmartScreen (si Windows)
Write-Host "`n3. ğŸ›¡ï¸ Statut SmartScreen:" -ForegroundColor Yellow
# Simuler une vÃ©rification de rÃ©putation (nÃ©cessite monitoring externe)
Write-Host "ğŸ“Š VÃ©rifier manuellement la rÃ©putation SmartScreen:" -ForegroundColor Gray
Write-Host "   â€¢ https://www.microsoft.com/en-us/wdsi/filesubmission" -ForegroundColor Gray
Write-Host "   â€¢ Soumettre: USB Video Vault Setup 0.1.4.exe" -ForegroundColor Gray

# 4. MÃ©triques d'utilisation
Write-Host "`n4. ğŸ“ˆ MÃ©triques:" -ForegroundColor Yellow
# Si tÃ©lÃ©mÃ©trie disponible, sinon mÃ©triques GitHub
$releasesUrl = "https://api.github.com/repos/150781/Yindo-USB-Video-Vault/releases"
try {
    $releases = Invoke-RestMethod -Uri $releasesUrl -Headers @{Accept="application/vnd.github.v3+json"} | Select-Object -First 3
    Write-Host "ğŸ“Š TÃ©lÃ©chargements des 3 derniÃ¨res releases:" -ForegroundColor Cyan
    $releases | ForEach-Object {
        $downloads = ($_.assets | Measure-Object download_count -Sum).Sum
        Write-Host "   â€¢ $($_.tag_name): $downloads tÃ©lÃ©chargements" -ForegroundColor Gray
    }
} catch {
    Write-Host "âš ï¸ Impossible de rÃ©cupÃ©rer les mÃ©triques" -ForegroundColor Yellow
}

Write-Host "`nâœ… Maintenance hebdomadaire terminÃ©e" -ForegroundColor Green
```

## ğŸ—“ï¸ **Maintenance mensuelle (1-2h)**

### SÃ©curitÃ© avancÃ©e et archivage
```powershell
# ğŸ” Maintenance mensuelle - Premier dimanche du mois

Write-Host "=== Maintenance mensuelle USB Video Vault ===" -ForegroundColor Cyan
Write-Host "Date: $(Get-Date -Format 'yyyy-MM-dd HH:mm')" -ForegroundColor Gray

# 1. Rotation des secrets GitHub
Write-Host "`n1. ğŸ”‘ Rotation des secrets (ACTION MANUELLE REQUISE):" -ForegroundColor Yellow
Write-Host "ğŸ“‹ Secrets Ã  vÃ©rifier/renouveler:" -ForegroundColor Cyan
Write-Host "   â€¢ WINDOWS_CERT_PASSWORD - Certificat de signature Windows" -ForegroundColor White
Write-Host "   â€¢ MACOS_CERT_PASSWORD - Certificat de signature macOS" -ForegroundColor White
Write-Host "   â€¢ GPG_PRIVATE_KEY - ClÃ© GPG pour signature des checksums" -ForegroundColor White
Write-Host "   â€¢ DEMO_PASSWORD - Mot de passe package dÃ©mo" -ForegroundColor White
Write-Host ""
Write-Host "ğŸ¯ Actions Ã  effectuer:" -ForegroundColor Yellow
Write-Host "   1. GitHub â†’ Settings â†’ Secrets and variables â†’ Actions" -ForegroundColor Gray
Write-Host "   2. Mettre Ã  jour les secrets arrivant Ã  expiration" -ForegroundColor Gray
Write-Host "   3. Tester avec un build de test" -ForegroundColor Gray

# 2. Backup chiffrÃ© du certificat Authenticode
Write-Host "`n2. ğŸ’¾ Backup des certificats:" -ForegroundColor Yellow
$backupDir = ".\backups\certificates\$(Get-Date -Format 'yyyy-MM')"
if (-not (Test-Path $backupDir)) {
    New-Item -ItemType Directory -Path $backupDir -Force | Out-Null
    Write-Host "ğŸ“ Dossier backup crÃ©Ã©: $backupDir" -ForegroundColor Green
}
Write-Host "ğŸ“‹ VÃ©rifier la sauvegarde chiffrÃ©e de:" -ForegroundColor Cyan
Write-Host "   â€¢ Certificat Authenticode (.p12/.pfx)" -ForegroundColor White
Write-Host "   â€¢ Certificat macOS (.p12)" -ForegroundColor White
Write-Host "   â€¢ ClÃ© GPG privÃ©e (export armor)" -ForegroundColor White

# 3. Purge et rotation des logs
Write-Host "`n3. ğŸ§¹ Nettoyage des logs:" -ForegroundColor Yellow
$logDirs = @(
    "$env:APPDATA\USB Video Vault\logs",
    ".\logs",
    ".\dist\logs"
)

foreach ($logDir in $logDirs) {
    if (Test-Path $logDir) {
        $oldLogs = Get-ChildItem $logDir -File | Where-Object { $_.LastWriteTime -lt (Get-Date).AddDays(-30) }
        if ($oldLogs) {
            Write-Host "ğŸ—‘ï¸ Suppression de $($oldLogs.Count) ancien(s) log(s) dans $logDir" -ForegroundColor Gray
            $oldLogs | Remove-Item -Force
        } else {
            Write-Host "âœ… Aucun log ancien dans $logDir" -ForegroundColor Green
        }
    }
}

# 4. Analyse des tendances et mÃ©triques
Write-Host "`n4. ğŸ“Š Rapport mensuel:" -ForegroundColor Yellow
$reportFile = ".\reports\monthly-report-$(Get-Date -Format 'yyyy-MM').txt"
$reportDir = Split-Path $reportFile -Parent
if (-not (Test-Path $reportDir)) {
    New-Item -ItemType Directory -Path $reportDir -Force | Out-Null
}

$report = @"
=== Rapport mensuel USB Video Vault - $(Get-Date -Format 'MMMM yyyy') ===

ğŸ“Š MÃ‰TRIQUES:
- TÃ©lÃ©chargements totaux: [Ã€ rÃ©cupÃ©rer depuis GitHub API]
- Issues fermÃ©es: [Ã€ rÃ©cupÃ©rer depuis GitHub API]
- Score sÃ©curitÃ© moyen: [Ã€ calculer depuis audits hebdomadaires]

ğŸ›¡ï¸ SÃ‰CURITÃ‰:
- Certificats: [VÃ©rifier dates d'expiration]
- VulnÃ©rabilitÃ©s: [RÃ©sumÃ© des audits]
- Secrets: [Statut rotation]

ğŸ”§ MAINTENANCE:
- Mises Ã  jour effectuÃ©es: [Liste]
- ProblÃ¨mes rÃ©solus: [Liste]
- Actions en cours: [Liste]

ğŸ“ˆ TENDANCES:
- Ã‰volution tÃ©lÃ©chargements
- Types d'issues les plus frÃ©quents
- Performance des builds

ğŸ¯ ACTIONS POUR LE MOIS PROCHAIN:
- [ ] TÃ¢che 1
- [ ] TÃ¢che 2
- [ ] TÃ¢che 3
"@

$report | Out-File $reportFile -Encoding UTF8
Write-Host "ğŸ“„ Rapport gÃ©nÃ©rÃ©: $reportFile" -ForegroundColor Cyan

# 5. VÃ©rification de l'Ã©tat des dÃ©pÃ´ts de distribution
Write-Host "`n5. ğŸ“¦ Statut distribution:" -ForegroundColor Yellow
Write-Host "ğŸ“‹ VÃ©rifier manuellement:" -ForegroundColor Cyan
Write-Host "   â€¢ Winget: https://github.com/microsoft/winget-pkgs/pulls?q=USB+Video+Vault" -ForegroundColor White
Write-Host "   â€¢ Chocolatey: https://community.chocolatey.org/packages/usbvideovault" -ForegroundColor White
Write-Host "   â€¢ GitHub Releases: https://github.com/150781/Yindo-USB-Video-Vault/releases" -ForegroundColor White

Write-Host "`nâœ… Maintenance mensuelle terminÃ©e" -ForegroundColor Green
Write-Host "ğŸ“„ Consulter le rapport: $reportFile" -ForegroundColor Cyan
}
```

## ğŸš¨ **ProcÃ©dures d'urgence**

### Rollback rapide
```powershell
# ğŸ”„ ProcÃ©dure de rollback d'urgence
# Usage: .\emergency-rollback.ps1 -FromVersion "1.0.1" -ToVersion "1.0.0" -Reason "Critical security issue"

param(
    [Parameter(Mandatory=$true)][string]$FromVersion,
    [Parameter(Mandatory=$true)][string]$ToVersion,
    [Parameter(Mandatory=$true)][string]$Reason
)

Write-Host "ğŸš¨ ROLLBACK D'URGENCE USB Video Vault" -ForegroundColor Red
Write-Host "De: v$FromVersion â†’ Vers: v$ToVersion" -ForegroundColor Yellow
Write-Host "Raison: $Reason" -ForegroundColor Yellow
Write-Host ""

$confirm = Read-Host "Confirmer le rollback d'urgence ? (CONFIRMER)"
if ($confirm -ne "CONFIRMER") {
    Write-Host "âŒ Rollback annulÃ©" -ForegroundColor Red
    exit 1
}

# 1. CrÃ©er une release d'urgence
Write-Host "1. ğŸ·ï¸ CrÃ©ation release d'urgence..." -ForegroundColor Yellow
gh release create "v$ToVersion-emergency" --title "Emergency Rollback to v$ToVersion" --notes "Emergency rollback from v$FromVersion to v$ToVersion due to: $Reason"

# 2. Marquer la version problÃ©matique
Write-Host "2. âš ï¸ Marquage version problÃ©matique..." -ForegroundColor Yellow
gh release edit "v$FromVersion" --prerelease

# 3. Notifications
Write-Host "3. ğŸ“¢ Notifications d'urgence..." -ForegroundColor Yellow
# Webhook Slack/Teams si configurÃ©
```

Write-Host "`nğŸ“‹ Actions post-rollback requises:" -ForegroundColor Cyan
Write-Host "   â€¢ Mettre Ã  jour Winget/Chocolatey avec la version rollback" -ForegroundColor White
Write-Host "   â€¢ Communiquer sur les canaux officiels" -ForegroundColor White
Write-Host "   â€¢ Documenter l'incident et la rÃ©solution" -ForegroundColor White
```

## ğŸ”§ **Scripts d'automatisation**

### Planificateur Windows
```batch
@echo off
REM TÃ¢che Windows pour monitoring quotidien
powershell.exe -ExecutionPolicy Bypass -File "C:\Path\To\USB-Video-Vault\tools\monitoring\daily-check.ps1"
```

### Cron Linux/macOS
```bash
# Monitoring quotidien - 9h00
0 9 * * * /usr/bin/powershell -File "/path/to/daily-check.ps1"

# Maintenance hebdomadaire - Dimanche 2h00
0 2 * * 0 /usr/bin/powershell -File "/path/to/weekly-maintenance.ps1"

# Maintenance mensuelle - Premier dimanche du mois 1h00
0 1 1-7 * 0 /usr/bin/powershell -File "/path/to/monthly-maintenance.ps1"
```

Cette infrastructure de monitoring vous permet de maintenir USB Video Vault de maniÃ¨re proactive avec une charge de travail minimale ! ğŸ¯